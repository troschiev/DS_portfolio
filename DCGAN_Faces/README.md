# DCGAN для генерации лиц

## Описание

Проект посвящен ручной реализации и обучению архитектуры на основе DCGAN. 

Задача - генерация более-менее фотореалистичных изображений.

## Инструменты

Загрузка, хранение и обработка данных: pytorch dataset/dataloader (тензоры), numpy (матрицы)

Визуализация: matplotlib, TSNE

Автоматизация: torchvision, sklearn, albumentations

Модели: pytorch - вручную созданы архитектуры дискриминатора и генератора

Индивидуальные решения:
- подбор количественных параметров сетей и гиперпараметров обучения
- реализация слоев гауссовского шума для нейронных сетей
- gradien penalty
- работа с метками: soft, зашумление, flip
- визуализация процесса обучения после каждой эпохи, построение итоговых сравнительных графиков
- метрики качества: Fréchet inception distance и Leave-one-out-1-NN классификация

## Данные

- [Flickr-Faces-HQ Dataset](https://github.com/NVlabs/ffhq-dataset)
- в работе использован ноутбук-заготовка, предоставленный DL school МФТИ. Ноутбук был значительно переработан под мои нужды.

## Выводы

- реализована классическая архитектура DCGAN для генерации разнообразных изображений лиц людей в разрешении 128х128

- реализованы дополнительные трюки для обучения:
    - переворот меток 0 и 1 при обучении для защиты от затухания градиентов
    - подмена меток на реальных фотографиях (выдача их за фейки) для защиты от коллапса мод
    - зашумление меток и soft labels
    - зашумление картинок
    - слои гауссовского шума в дискриминаторе и генераторе перед слоями свертки
    - буфер для сгенерированных изображений
    - добавлен Gradient Penalty, увеличивающий лосс при "длине" градиентов, отличающейся от единицы
    
- вручную экспериментально подобраны гиперпараметры обучения, в частности, количество фильтров в генераторе и дискриминаторе и размер батча. Все эти параметры критически важны для скорости обучения и качества работы сети

- реализованы расчет и отображение метрик:
    - получение эмбеддингов/латентных векторов изображений предобученной на imagenet сетью
    - Fréchet inception distance
    - Leave-one-out-1-NN классификация
    - t-SNE изображение признаков настоящих и сгенерированных изображений на двумерном графике

## Иллюстрации

Процесс обучения по эпохам:

![epochs_gif](outputs/_animated_.gif "epochs")

Сгенерированные лица (каждый ряд - плавный переход из одного случайного латентного вектора в другой)

![vary](outputs/vary_latent.png)
